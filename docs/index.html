<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Deciphering Biological Networks with Patterned Heterogeneous Measurements • Patterns</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Deciphering Biological Networks with Patterned Heterogeneous Measurements">
<meta property="og:description" content="A modeling tool dedicated to biological network modeling (Bertrand and others 2020, &lt;doi:10.1093/bioinformatics/btaa855&gt;). It allows for single or joint modeling of, for instance, genes and proteins. It starts with the selection of the actors that will be the used in the reverse engineering upcoming step. An actor can be included in that selection based on its differential measurement (for instance gene expression or protein abundance) or on its time course profile. Wrappers for actors clustering functions and cluster analysis are provided. It also allows reverse engineering of biological networks taking into account the observed time course patterns of the actors. Many inference functions are provided and dedicated to get specific features for the inferred network such as sparsity, robust links, high confidence links or stable through resampling links. Some simulation and prediction tools are also available for cascade networks (Jung and others 2014, &lt;doi:10.1093/bioinformatics/btt705&gt;). Example of use with microarray or RNA-Seq data are provided.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">Patterns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ExampleCLL.html">Network inference and analysis of CLL data</a>
    </li>
    <li>
      <a href="articles/IntroPatterns.html">Introduction to Patterns: a modeling tool dedicated to biological network modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fbertran/Patterns/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="patterns-">Patterns <img src="reference/figures/logo.png" align="right" width="200"><a class="anchor" aria-label="anchor" href="#patterns-"></a>
</h1></div>
</div>
<div class="section level1">
<h1 id="a-modeling-tool-dedicated-to-biological-network-modeling-to-decipher-biological-networks-with-patterned-heterogeneous-eg-multiomics-measurements">A modeling tool dedicated to biological network modeling to decipher Biological Networks with Patterned Heterogeneous (e.g. multiOmics) Measurements<a class="anchor" aria-label="anchor" href="#a-modeling-tool-dedicated-to-biological-network-modeling-to-decipher-biological-networks-with-patterned-heterogeneous-eg-multiomics-measurements"></a>
</h1>
<div class="section level2">
<h2 id="frédéric-bertrand-and-myriam-maumy-bertrand">Frédéric Bertrand and Myriam Maumy-Bertrand<a class="anchor" aria-label="anchor" href="#fr%C3%A9d%C3%A9ric-bertrand-and-myriam-maumy-bertrand"></a>
</h2>
<!-- badges: start -->

<p>It is designed to work with <strong>patterned data</strong>. Famous examples of problems related to patterned data are:</p>
<ul>
<li>recovering <strong>signals</strong> in networks after a <strong>stimulation</strong> (cascade network reverse engineering),</li>
<li>analysing <strong>periodic signals</strong>.</li>
</ul>
<p>It allows for <strong>single</strong> or <strong>joint modeling</strong> of, for instance, genes and proteins.</p>
<ul>
<li>It starts with the <strong>selection of the actors</strong> that will be the used in the reverse engineering upcoming step. An actor can be included in that selection based on its <strong>differential effects</strong> (for instance gene expression or protein abundance) or on its <strong>time course profile</strong>.</li>
<li>Wrappers for <strong>actors clustering</strong> functions and cluster analysis are provided.</li>
<li>It also allows <strong>reverse engineering</strong> of biological networks taking into account the observed time course patterns of the actors. Interactions between clusters of actors can be set by the user. Any number of clusters can be activated at a single time.</li>
<li>Many <strong>inference functions</strong> are provided with the <code>Patterns</code> package and dedicated to get <strong>specific features</strong> for the inferred network such as <strong>sparsity</strong>, <strong>robust links</strong>, <strong>high confidence links</strong> or <strong>stable through resampling links</strong>.
<ul>
<li>
<strong>lasso</strong>, from the <code>lars</code> package</li>
<li>
<strong>lasso</strong>, from the <code>glmnet</code> package. An unweighted and a weighted version of the algorithm are available</li>
<li>
<strong>spls</strong>, from the <code>spls</code> package</li>
<li>
<strong>elasticnet</strong>, from the <code>elasticnet</code> package</li>
<li>
<strong>stability selection</strong>, from the <code>c060</code> package implementation of stability selection</li>
<li>
<strong>weighted stability selection</strong>, a new weighted version of the <code>c060</code> package implementation of stability selection that I created for the package</li>
<li>
<strong>robust</strong>, lasso from the <code>lars</code> package with light random Gaussian noise added to the explanatory variables</li>
<li>
<strong>selectboost</strong>, from the <code>selectboost</code> package. The selectboost algorithm looks for the more stable links against resampling that takes into account the correlated structure of the predictors</li>
<li>
<strong>weighted selectboost</strong>, a new weighted version of the <code>selectboost</code>.</li>
</ul>
</li>
<li>Some <strong>simulation</strong> and <strong>prediction</strong> tools are also available for cascade networks.</li>
<li>Examples of use with microarray or RNA-Seq data are provided.</li>
</ul>
<p>The weights are viewed as a penalty factors in the penalized regression model: it is a number that multiplies the lambda value in the minimization problem to allow differential shrinkage, <a href="https://github.com/fbertran/Patterns/raw/master/add_data/glmnet.pdf" class="external-link">Friedman et al. 2010</a>, equation 1 page 3. If equal to 0, it implies no shrinkage, and that variable is always included in the model. Default is 1 for all variables. Infinity means that the variable is excluded from the model. Note that the weights are rescaled to sum to the number of variables.</p>
<p>A word for those that have been using our seminal work, the <code>Cascade</code> package that we created several years ago and that was a very efficient network reverse engineering tool for cascade networks (Jung, N., Bertrand, F., Bahram, S., Vallat, L., and Maumy-Bertrand, M. (2014), <a href="https://doi.org/10.1093/bioinformatics/btt705" class="external-link uri">https://doi.org/10.1093/bioinformatics/btt705</a>, <a href="https://cran.r-project.org/package=Cascade" class="external-link uri">https://cran.r-project.org/package=Cascade</a>, <a href="https://github.com/fbertran/Cascade" class="external-link uri">https://github.com/fbertran/Cascade</a> and <a href="https://fbertran.github.io/Cascade/" class="external-link uri">https://fbertran.github.io/Cascade/</a>).</p>
<p>The <code>Patterns</code> package is more than (at least) a threeway major extension of the <code>Cascade</code> package :</p>
<ul>
<li>
<strong>any number of groups</strong> can be used whereas in the <code>Cascade</code> package only 1 group for each timepoint could be created, which prevented the users to create homogeneous clusters of genes in datasets that featured more than a few dozens of genes.</li>
<li>
<strong>custom</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrices shapes whereas in the <code>Cascade</code> package only 1 shape was provided:
<ul>
<li>interaction between groups</li>
<li>custom design of inner cells of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrix</li>
</ul>
</li>
<li>the custom <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrices allow to deal with <strong>heteregeneous networks</strong> with several kinds of actors such as mixing genes and proteins in a single network to perform <strong>joint inference</strong>.</li>
<li>about <strong>nine inference algorithms</strong> are provided, whereas 1 (lasso) in <code>Cascade</code>.</li>
</ul>
<p>Hence the <code>Patterns</code> package should be viewed more as a completely new modelling tools than as an extension of the <code>Cascade</code> package.</p>
<p>This website and these examples were created by F. Bertrand and M. Maumy-Bertrand.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of Patterns from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"Patterns"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of Patterns from <a href="https://github.com" class="external-link">github</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"fbertran/Patterns"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="data-management">Data management<a class="anchor" aria-label="anchor" href="#data-management"></a>
</h3>
<p>Import Cascade Data (repeated measurements on several subjects) from the CascadeData package and turn them into a omics array object. The second line makes sure the CascadeData package is installed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/Patterns/" class="external-link">Patterns</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/CascadeData/" class="external-link">CascadeData</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"CascadeData"</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">micro_US</span><span class="op">)</span></span>
<span><span class="va">micro_US</span><span class="op">&lt;-</span><span class="fu"><a href="reference/as.omics_array.html">as.omics_array</a></span><span class="op">(</span><span class="va">micro_US</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span>,time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">90</span>,<span class="fl">210</span>,<span class="fl">390</span><span class="op">)</span>,subject<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">micro_US</span><span class="op">)</span></span>
<span><span class="co">#&gt; Formal class 'omics_array' [package "Patterns"] with 7 slots</span></span>
<span><span class="co">#&gt;   ..@ omicsarray: num [1:100, 1:24] 103.2 26 70.7 213.7 13.7 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:100] "1007_s_at" "1053_at" "117_at" "121_at" ...</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:24] "N1_US_T60" "N1_US_T90" "N1_US_T210" "N1_US_T390" ...</span></span>
<span><span class="co">#&gt;   ..@ name      : chr [1:100] "1007_s_at" "1053_at" "117_at" "121_at" ...</span></span>
<span><span class="co">#&gt;   ..@ gene_ID   : num 0</span></span>
<span><span class="co">#&gt;   ..@ group     : num 0</span></span>
<span><span class="co">#&gt;   ..@ start_time: num 0</span></span>
<span><span class="co">#&gt;   ..@ time      : num [1:4] 60 90 210 390</span></span>
<span><span class="co">#&gt;   ..@ subject   : num 6</span></span></code></pre></div>
<p>Get a summay and plots of the data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">micro_US</span><span class="op">)</span></span>
<span><span class="co">#&gt;    N1_US_T60        N1_US_T90        N1_US_T210       N1_US_T390    </span></span>
<span><span class="co">#&gt;  Min.   :  12.2   Min.   :  12.9   Min.   :   1.5   Min.   :  10.1  </span></span>
<span><span class="co">#&gt;  1st Qu.: 177.7   1st Qu.: 198.7   1st Qu.: 189.0   1st Qu.: 196.7  </span></span>
<span><span class="co">#&gt;  Median : 513.0   Median : 499.4   Median : 608.5   Median : 541.2  </span></span>
<span><span class="co">#&gt;  Mean   :1386.6   Mean   :1357.7   Mean   :1450.4   Mean   :1331.2  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1912.3   3rd Qu.:1883.4   3rd Qu.:2050.2   3rd Qu.:1646.2  </span></span>
<span><span class="co">#&gt;  Max.   :6348.4   Max.   :6507.3   Max.   :6438.5   Max.   :6351.4  </span></span>
<span><span class="co">#&gt;    N2_US_T60        N2_US_T90        N2_US_T210       N2_US_T390    </span></span>
<span><span class="co">#&gt;  Min.   :  16.7   Min.   :   3.4   Min.   :   5.5   Min.   :   6.1  </span></span>
<span><span class="co">#&gt;  1st Qu.: 212.4   1st Qu.: 185.7   1st Qu.: 214.7   1st Qu.: 230.1  </span></span>
<span><span class="co">#&gt;  Median : 584.1   Median : 501.5   Median : 596.0   Median : 601.8  </span></span>
<span><span class="co">#&gt;  Mean   :1381.9   Mean   :1345.4   Mean   :1410.5   Mean   :1403.7  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1616.2   3rd Qu.:1830.5   3rd Qu.:2005.8   3rd Qu.:1901.7  </span></span>
<span><span class="co">#&gt;  Max.   :6149.3   Max.   :6090.8   Max.   :6160.6   Max.   :6143.1  </span></span>
<span><span class="co">#&gt;    N3_US_T60        N3_US_T90        N3_US_T210       N3_US_T390    </span></span>
<span><span class="co">#&gt;  Min.   :   1.9   Min.   :  10.3   Min.   :   3.3   Min.   :   6.6  </span></span>
<span><span class="co">#&gt;  1st Qu.: 187.4   1st Qu.: 194.6   1st Qu.: 177.8   1st Qu.: 222.6  </span></span>
<span><span class="co">#&gt;  Median : 611.4   Median : 576.2   Median : 552.2   Median : 593.7  </span></span>
<span><span class="co">#&gt;  Mean   :1365.4   Mean   :1381.2   Mean   :1310.1   Mean   :1427.1  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1855.2   3rd Qu.:2040.2   3rd Qu.:1784.5   3rd Qu.:2131.7  </span></span>
<span><span class="co">#&gt;  Max.   :6636.6   Max.   :6515.5   Max.   :6530.4   Max.   :6177.2  </span></span>
<span><span class="co">#&gt;    N4_US_T60        N4_US_T90        N4_US_T210       N4_US_T390    </span></span>
<span><span class="co">#&gt;  Min.   :  20.2   Min.   :  15.6   Min.   :  19.8   Min.   :   9.3  </span></span>
<span><span class="co">#&gt;  1st Qu.: 199.3   1st Qu.: 215.4   1st Qu.: 207.0   1st Qu.: 197.8  </span></span>
<span><span class="co">#&gt;  Median : 610.8   Median : 614.0   Median : 544.9   Median : 590.7  </span></span>
<span><span class="co">#&gt;  Mean   :1505.1   Mean   :1526.7   Mean   :1401.6   Mean   :1458.8  </span></span>
<span><span class="co">#&gt;  3rd Qu.:2198.1   3rd Qu.:2168.9   3rd Qu.:1831.2   3rd Qu.:1984.8  </span></span>
<span><span class="co">#&gt;  Max.   :6986.2   Max.   :7148.0   Max.   :6820.0   Max.   :6762.3  </span></span>
<span><span class="co">#&gt;    N5_US_T60        N5_US_T90        N5_US_T210       N5_US_T390    </span></span>
<span><span class="co">#&gt;  Min.   :   3.4   Min.   :  10.0   Min.   :  10.7   Min.   :  16.5  </span></span>
<span><span class="co">#&gt;  1st Qu.: 213.2   1st Qu.: 209.8   1st Qu.: 202.0   1st Qu.: 208.2  </span></span>
<span><span class="co">#&gt;  Median : 609.4   Median : 561.3   Median : 555.6   Median : 570.5  </span></span>
<span><span class="co">#&gt;  Mean   :1498.2   Mean   :1424.8   Mean   :1394.1   Mean   :1435.3  </span></span>
<span><span class="co">#&gt;  3rd Qu.:2008.7   3rd Qu.:1906.5   3rd Qu.:1923.9   3rd Qu.:1867.8  </span></span>
<span><span class="co">#&gt;  Max.   :7268.2   Max.   :6857.8   Max.   :6574.0   Max.   :6896.6  </span></span>
<span><span class="co">#&gt;    N6_US_T60        N6_US_T90        N6_US_T210       N6_US_T390    </span></span>
<span><span class="co">#&gt;  Min.   :  13.0   Min.   :   6.6   Min.   :   3.8   Min.   :  14.4  </span></span>
<span><span class="co">#&gt;  1st Qu.: 207.5   1st Qu.: 198.6   1st Qu.: 203.9   1st Qu.: 195.8  </span></span>
<span><span class="co">#&gt;  Median : 516.2   Median : 530.6   Median : 578.0   Median : 580.0  </span></span>
<span><span class="co">#&gt;  Mean   :1412.9   Mean   :1388.3   Mean   :1416.5   Mean   :1360.8  </span></span>
<span><span class="co">#&gt;  3rd Qu.:2037.4   3rd Qu.:1889.8   3rd Qu.:2030.8   3rd Qu.:1872.6  </span></span>
<span><span class="co">#&gt;  Max.   :6898.1   Max.   :6749.4   Max.   :6490.0   Max.   :6780.2</span></span></code></pre></div>
<p><img src="reference/figures/README-plotomicsarrayclass-1.png" title="plot of chunk plotomicsarrayclass" alt="plot of chunk plotomicsarrayclass" width="100%"><img src="reference/figures/README-plotomicsarrayclass-2.png" title="plot of chunk plotomicsarrayclass" alt="plot of chunk plotomicsarrayclass" width="100%"><img src="reference/figures/README-plotomicsarrayclass-3.png" title="plot of chunk plotomicsarrayclass" alt="plot of chunk plotomicsarrayclass" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">micro_US</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plotomicsarrayclass-4.png" title="plot of chunk plotomicsarrayclass" alt="plot of chunk plotomicsarrayclass" width="100%"></p>
</div>
<div class="section level3">
<h3 id="gene-selection">Gene selection<a class="anchor" aria-label="anchor" href="#gene-selection"></a>
</h3>
<p>There are several functions to carry out gene selection before the inference. They are detailed in the vignette of the package.</p>
</div>
<div class="section level3">
<h3 id="data-simulation">Data simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h3>
<p>Let’s simulate some cascade data and then do some reverse engineering.</p>
<p>We first design the F matrix for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">T_i=4</annotation></semantics></math> times and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>g</mi><mi>r</mi><mi>p</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">Ngrp=4</annotation></semantics></math> groups. The <code>Fmat</code>object is an array of sizes <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo>,</mo><mi>T</mi><mo>−</mo><mi>i</mi><mo>,</mo><mi>N</mi><mi>g</mi><mi>r</mi><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>16</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(T_i,T-i,Ngrp^2)=(4,4,16)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ti</span><span class="op">&lt;-</span><span class="fl">4</span></span>
<span><span class="va">Ngrp</span><span class="op">&lt;-</span><span class="fl">4</span></span>
<span></span>
<span><span class="va">Fmat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>,dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Ti</span>,<span class="va">Ti</span>,<span class="va">Ngrp</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ti</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="va">Ti</span><span class="op">)</span> <span class="op">&gt;</span> <span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="va">Ti</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">Fmat</span><span class="op">[</span>,,<span class="va">i</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">Ti</span>,<span class="fl">1</span><span class="op">:</span><span class="va">Ti</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="fl">0</span><span class="op">&lt;</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">y</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">2</span><span class="op">}</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <code>Patterns</code> function <code>CascadeFinit</code> is an utility function to easily define such an F matrix.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fbis</span><span class="op">=</span><span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="va">Ti</span>,<span class="va">Ngrp</span>,low.trig<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Fbis</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:4, 1:4, 1:16] 0 0 0 0 0 0 0 0 0 0 ...</span></span></code></pre></div>
<p>Check if the two matrices <code>Fmat</code> and <code>Fbis</code> are identical.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">Fmat</span><span class="op">==</span><span class="va">Fbis</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>End of F matrix definition.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fmat</span><span class="op">[</span>,,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Fmat</span><span class="op">[</span>,,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="fl">0.2</span></span>
<span><span class="va">Fmat</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">Fmat</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">Fmat</span><span class="op">[</span>,,<span class="fl">4</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Fmat</span><span class="op">[</span>,,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="fl">0.3</span></span>
<span><span class="va">Fmat</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">Fmat</span><span class="op">[</span>,,<span class="fl">8</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Fmat</span><span class="op">[</span>,,<span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<p>We set the seed to make the results reproducible and draw a scale free random network.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Net</span><span class="op">&lt;-</span><span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/network_random.html">network_random</a></span><span class="op">(</span></span>
<span>  nb<span class="op">=</span><span class="fl">100</span>,</span>
<span>  time_label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,each<span class="op">=</span><span class="fl">25</span><span class="op">)</span>,</span>
<span>  exp<span class="op">=</span><span class="fl">1</span>,</span>
<span>  init<span class="op">=</span><span class="fl">1</span>,</span>
<span>  regul<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,</span>
<span>  min_expr<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>  max_expr<span class="op">=</span><span class="fl">2</span>,</span>
<span>  casc.level<span class="op">=</span><span class="fl">0.4</span></span>
<span><span class="op">)</span></span>
<span><span class="va">Net</span><span class="op">@</span><span class="va">F</span><span class="op">&lt;-</span><span class="va">Fmat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Net</span><span class="op">)</span></span>
<span><span class="co">#&gt; Formal class 'omics_network' [package "Patterns"] with 6 slots</span></span>
<span><span class="co">#&gt;   ..@ omics_network: num [1:100, 1:100] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..@ name         : chr [1:100] "gene 1" "gene 2" "gene 3" "gene 4" ...</span></span>
<span><span class="co">#&gt;   ..@ F            : num [1:4, 1:4, 1:16] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..@ convF        : num [1, 1] 0</span></span>
<span><span class="co">#&gt;   ..@ convO        : num 0</span></span>
<span><span class="co">#&gt;   ..@ time_pt      : int [1:4] 1 2 3 4</span></span></code></pre></div>
<p>Plot the simulated network.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net</span>, choice<span class="op">=</span><span class="st">"network"</span><span class="op">)</span></span></code></pre></div>
<p>If a gene clustering is known, it can be used as a coloring scheme.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net</span>, choice<span class="op">=</span><span class="st">"network"</span>, gr<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,each<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plot the F matrix, for low dimensional F matrices.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotF-1.png" alt="plot of chunk plotF" width="100%"><p class="caption">
plot of chunk plotF
</p>
</div>
<p>Plot the F matrix using the <code>pixmap</code> package, for high dimensional F matrices.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net</span>, choice<span class="op">=</span><span class="st">"Fpixmap"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotFpixmap-1.png" alt="plot of chunk plotFpixmap" width="100%"><p class="caption">
plot of chunk plotFpixmap
</p>
</div>
<p>We simulate gene expression according to the network that was previously drawn</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/gene_expr_simulation-omics_network-method.html">gene_expr_simulation</a></span><span class="op">(</span></span>
<span>  network<span class="op">=</span><span class="va">Net</span>,</span>
<span>  time_label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,each<span class="op">=</span><span class="fl">25</span><span class="op">)</span>,</span>
<span>  subject<span class="op">=</span><span class="fl">5</span>,</span>
<span>  peak_level<span class="op">=</span><span class="fl">200</span>,</span>
<span>  act_time_group<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: unable to find an inherited method for function 'gene_expr_simulation' for signature 'omics_network = "missing"'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'M' not found</span></span></code></pre></div>
<p>Get a summay and plots of the simulated data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'object' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'summary' : objet 'M' introuvable</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'x' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'plot' : objet 'M' introuvable</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="network-inferrence">Network inferrence<a class="anchor" aria-label="anchor" href="#network-inferrence"></a>
</h3>
<p>We infer the new network using subjectwise leave one out cross-validation (default setting): all measurements from the same subject are removed from the dataset). The inference is carried out with a general Fshape.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, cv.subjects<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P' not found</span></span></code></pre></div>
<p>Heatmap of the inferred coefficients of the Omega matrix</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P' not found</span></span></code></pre></div>
<p>Default values fot the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrices. The <code>Finit</code> matrix (starting values for the algorithm). In our case, the <code>Finit</code>object is an array of sizes <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo>,</mo><mi>T</mi><mo>−</mo><mi>i</mi><mo>,</mo><mi>N</mi><mi>g</mi><mi>r</mi><msup><mi>p</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>16</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(T_i,T-i,Ngrp^2)=(4,4,16)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ti</span><span class="op">&lt;-</span><span class="fl">4</span>;</span>
<span><span class="va">ngrp</span><span class="op">&lt;-</span><span class="fl">4</span></span>
<span><span class="va">nF</span><span class="op">&lt;-</span><span class="va">ngrp</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">Finit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Ti</span>,<span class="va">Ti</span>,<span class="va">nF</span><span class="op">)</span><span class="op">)</span> </span>
<span>              <span class="kw">for</span><span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nF</span><span class="op">)</span><span class="op">{</span>    </span>
<span>                <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="va">ii</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="op">(</span><span class="va">ngrp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>                  <span class="va">Finit</span><span class="op">[</span>,,<span class="va">ii</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span>                <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>                  <span class="va">Finit</span><span class="op">[</span>,,<span class="va">ii</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Ti</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">Ti</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Ti</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Ti</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">Ti</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Ti</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="op">}</span></span>
<span>              <span class="op">}</span></span></code></pre></div>
<p>The <code>Fshape</code> matrix (default shape for <code>F</code> matrix the algorithm). Any interaction between groups and times are permitted except the retro-actions (a group on itself, or an action at the same time for an actor on another one).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fshape</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Ti</span>,<span class="va">Ti</span>,<span class="va">nF</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nF</span><span class="op">)</span><span class="op">{</span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="va">ii</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="op">(</span><span class="va">ngrp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">Fshape</span><span class="op">[</span>,,<span class="va">ii</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"0"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">lchars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">Ti</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="va">tempFshape</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="va">Ti</span>,<span class="va">Ti</span><span class="op">)</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">bb</span> <span class="kw">in</span> <span class="op">(</span><span class="op">-</span><span class="va">Ti</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">Ti</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">tempFshape</span><span class="op">&lt;-</span><span class="fu"><a href="reference/replaceUp.html">replaceUp</a></span><span class="op">(</span><span class="va">tempFshape</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">lchars</span><span class="op">[</span><span class="va">bb</span><span class="op">+</span><span class="va">Ti</span><span class="op">]</span>,<span class="va">Ti</span>,<span class="va">Ti</span><span class="op">)</span>,<span class="op">-</span><span class="va">bb</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">tempFshape</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/replaceBand.html">replaceBand</a></span><span class="op">(</span><span class="va">tempFshape</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="va">Ti</span>,<span class="va">Ti</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">Fshape</span><span class="op">[</span>,,<span class="va">ii</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">tempFshape</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Any other form can be used. A “0” coefficient is missing from the model. It allows testing the best structure of an “F” matrix and even performing some significance tests of hypothses on the structure of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrix.</p>
<p>The <code>IndicFshape</code> function allows to design custom F matrix for cascade networks with equally spaced measurements by specifying the zero and non zero <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">F_{ij}</annotation></semantics></math> cells of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrix. It is useful for models featuring several clusters of actors that are activated at the time. Let’s define the following indicatrix matrix (action of all groups on each other, which is not a possible real modeling setting and is only used as an example):</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TestIndic</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ti</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="op">(</span><span class="va">ngrp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,byrow<span class="op">=</span><span class="cn">TRUE</span>,<span class="va">ngrp</span>,<span class="va">ngrp</span><span class="op">)</span></span>
<span><span class="va">TestIndic</span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]</span></span>
<span><span class="co">#&gt; [1,] FALSE  TRUE  TRUE  TRUE</span></span>
<span><span class="co">#&gt; [2,]  TRUE FALSE  TRUE  TRUE</span></span>
<span><span class="co">#&gt; [3,]  TRUE  TRUE FALSE  TRUE</span></span>
<span><span class="co">#&gt; [4,]  TRUE  TRUE  TRUE FALSE</span></span></code></pre></div>
<p>For that choice, we get those init and shape <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrices.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/IndicFinit.html">IndicFinit</a></span><span class="op">(</span><span class="va">Ti</span>,<span class="va">ngrp</span>,<span class="va">TestIndic</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    0</span></span>
<span><span class="fu"><a href="reference/IndicFshape.html">IndicFshape</a></span><span class="op">(</span><span class="va">Ti</span>,<span class="va">ngrp</span>,<span class="va">TestIndic</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "a1" "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "a2" "a1" "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "a3" "a2" "a1" "0" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [2,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [3,] "0"  "0"  "0"  "0" </span></span>
<span><span class="co">#&gt; [4,] "0"  "0"  "0"  "0"</span></span></code></pre></div>
<p>Those <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrices are lower diagonal ones to enforce that an observed value at a given time can only be predicted by a value that was observed in the past only (i.e. neither at the same moment or in the future).</p>
<p>The <code>plotF</code> is convenient to display F matrices. Here are the the displays of the three <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrices we have just introduced.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotF.html">plotF</a></span><span class="op">(</span><span class="va">Fshape</span>,choice<span class="op">=</span><span class="st">"Fshape"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotfshape1-1.png" alt="plot of chunk plotfshape1" width="100%"><p class="caption">
plot of chunk plotfshape1
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotF.html">plotF</a></span><span class="op">(</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,choice<span class="op">=</span><span class="st">"Fshape"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotfshape2-1.png" alt="plot of chunk plotfshape2" width="100%"><p class="caption">
plot of chunk plotfshape2
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotF.html">plotF</a></span><span class="op">(</span><span class="fu"><a href="reference/IndicFshape.html">IndicFshape</a></span><span class="op">(</span><span class="va">Ti</span>,<span class="va">ngrp</span>,<span class="va">TestIndic</span><span class="op">)</span>,choice<span class="op">=</span><span class="st">"Fshape"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotfshape3-1.png" alt="plot of chunk plotfshape3" width="100%"><p class="caption">
plot of chunk plotfshape3
</p>
</div>
<p>We now fit the model with an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrix that is designed for cascade networks.</p>
<p>Specific Fshape</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_S</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_S</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_S' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network. They reflect the use of a special <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> matrix. It is an example of an F matrix specifically designed to deal with cascade networks.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_S</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_S' not found</span></span></code></pre></div>
<p>There are many fitting functions provided with the <code>Patterns</code> package in order to search for <strong>specific features</strong> for the inferred network such as <strong>sparsity</strong>, <strong>robust links</strong>, <strong>high confidence links</strong> or <strong>stable through resampling links</strong>. :</p>
<ul>
<li>
<strong>LASSO</strong>, from the <code>lars</code> package</li>
<li>
<strong>LASSO2</strong>, from the <code>glmnet</code> package. An unweighted and a weighted version of the algorithm are available</li>
<li>
<strong>SPLS</strong>, from the <code>spls</code> package</li>
<li>
<strong>ELASTICNET</strong>, from the <code>elasticnet</code> package</li>
<li>
<strong>stability.c060</strong>, from the <code>c060</code> package implementation of stability selection</li>
<li>
<strong>stability.c060.weighted</strong>, a new weighted version of the <code>c060</code> package implementation of stability selection</li>
<li>
<strong>robust</strong>, lasso from the <code>lars</code> package with light random Gaussian noise added to the explanatory variables</li>
<li>
<strong>selectboost.weighted</strong>, a new weighted version of the <code>selectboost</code> package implementation of the selectboost algorithm to look for the more stable links against resampling that takes into account the correlated structure of the predictors. If no weights are provided, equal weigths are for all the variables (=non weighted case).</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_Lasso2</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"LASSO2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_Lasso2</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_Lasso2' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_Lasso2</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_Lasso2' not found</span></span></code></pre></div>
<p>We create a weighting vector to perform weighted lasso inference.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weights_Net</span><span class="op">=</span><span class="fu">slot</span><span class="op">(</span><span class="va">Net</span>,<span class="st">"network"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in slot(Net, "network"): no slot of name "network" for this object of class "omics_network"</span></span>
<span><span class="va">Weights_Net</span><span class="op">[</span><span class="va">Net</span><span class="op">@</span><span class="va">network</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">=</span><span class="fl">.1</span>        </span>
<span><span class="co">#&gt; Error: object 'Weights_Net' not found</span></span>
<span><span class="va">Weights_Net</span><span class="op">[</span><span class="va">Net</span><span class="op">@</span><span class="va">network</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span><span class="op">=</span><span class="fl">1000</span></span>
<span><span class="co">#&gt; Error: object 'Weights_Net' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_Lasso2_Weighted</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"LASSO2"</span>, priors<span class="op">=</span><span class="va">Weights_Net</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_Lasso2_Weighted</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_Lasso2_Weighted' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_Lasso2_Weighted</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_Lasso2_Weighted' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_SPLS</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"SPLS"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_SPLS</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_SPLS' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_SPLS</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_SPLS' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_ELASTICNET</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"ELASTICNET"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_ELASTICNET</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_ELASTICNET' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_ELASTICNET</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_ELASTICNET' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_stability</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"stability.c060"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_stability</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_stability' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_stability</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_stability' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_StabWeight</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"stability.c060.weighted"</span>, priors<span class="op">=</span><span class="va">Weights_Net</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_StabWeight</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_StabWeight' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_StabWeight</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_StabWeight' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_Robust</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"robust"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_Robust</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_Robust' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_Robust</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_Robust' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weights_Net_1</span> <span class="op">&lt;-</span> <span class="va">Weights_Net</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): objet 'Weights_Net' introuvable</span></span>
<span><span class="va">Weights_Net_1</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co">#&gt; Error in Weights_Net_1[, ] &lt;- 1: objet 'Weights_Net_1' introuvable</span></span>
<span><span class="va">Net_inf_P_SelectBoost</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"selectboost.weighted"</span>,priors<span class="op">=</span><span class="va">Weights_Net_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Attaching package: 'Patterns'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:igraph':</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;     compare</span></span></code></pre>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_SelectBoost</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_SelectBoost' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_SelectBoost</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_SelectBoost' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_inf_P_SelectBoostWeighted</span> <span class="op">&lt;-</span> <span class="fu">Patterns</span><span class="fu">::</span><span class="fu"><a href="reference/inference.html">inference</a></span><span class="op">(</span><span class="va">M</span>, Finit<span class="op">=</span><span class="fu"><a href="reference/CascadeFinit.html">CascadeFinit</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, Fshape<span class="op">=</span><span class="fu"><a href="reference/CascadeFshape.html">CascadeFshape</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, fitfun<span class="op">=</span><span class="st">"selectboost.weighted"</span>,priors<span class="op">=</span><span class="va">Weights_Net</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): erreur d'ï¿½valuation de l'argument 'M' lors de la sï¿½lection d'une mï¿½thode pour la fonction 'inference' : objet 'M' introuvable</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Attaching package: 'Patterns'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:igraph':</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;     compare</span></span></code></pre>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Net_inf_P_SelectBoostWeighted</span>, choice<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'Net_inf_P_SelectBoostWeighted' not found</span></span></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">Net_inf_P_SelectBoostWeighted</span><span class="op">@</span><span class="va">network</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span>, revC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'Net_inf_P_SelectBoostWeighted' not found</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="post-inference-network-analysis">Post inference network analysis<a class="anchor" aria-label="anchor" href="#post-inference-network-analysis"></a>
</h3>
<p>Such an analysis is only required if the model was not fitted using the stability selection or the selectboost algorithm.</p>
<p>Create an animation of the network with increasing cutoffs with an animated .gif format or a html webpage in the working directory.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span></span>
<span><span class="va">sequence</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span>,length.out<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/evolution-omics_network-method.html">evolution</a></span><span class="op">(</span><span class="va">network</span>,<span class="va">sequence</span>,type.ani <span class="op">=</span> <span class="st">"gif"</span>, outdir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/evolution-omics_network-method.html">evolution</a></span><span class="op">(</span><span class="va">network</span>,<span class="va">sequence</span>,type.ani <span class="op">=</span> <span class="st">"html"</span>, outdir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Error in setwd(outdir): cannot change working directory</span></span>
<span><span class="co">#&gt; Error in setwd(outdir): cannot change working directory</span></span></code></pre>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/evolution/animation.gif" alt="Evolution as .gif."><div class="figcaption">Evolution as .gif.</div>
</div>
<p><a href="https://fbertran.github.io/Patterns/reference/evolution/index.html" class="external-link">Evolution as .html.</a></p>
<p>Evolution of some properties of a reverse-engineered network with increasing cut-off values. <img src="https://fbertran.github.io/Patterns/reference/compare-methods-1.png" alt="Evolution of some properties of a reverse-engineered network with increasing cut-off values."></p>
<p>We switch to data that were derived from the inferrence of a real biological network and try to detect the optimal cutoff value: the best cutoff value for a network to fit a scale free network. The <code>cutoff</code> was validated only single group cascade networks (number of actors groups = number of timepoints) and for genes dataset. Instead of the <code>cutoff</code> function, manual curation or the stability selection or the selectboost algorithm should be used.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"networkCascade"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cutoff-omics_network-method.html">cutoff</a></span><span class="op">(</span><span class="va">networkCascade</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in (function (classes, fdef, mtable) : impossible de trouver une méthode héritée pour la fonction 'cutoff' pour la signature '"network"'</span></span></code></pre></div>
<p>Analyze the network with a cutoff set to the previouly found 0.133 optimal value.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/analyze_network-omics_network-method.html">analyze_network</a></span><span class="op">(</span><span class="va">networkCascade</span>,nv<span class="op">=</span><span class="fl">0.133</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in (function (classes, fdef, mtable) : impossible de trouver une méthode héritée pour la fonction 'analyze_network' pour la signature '"network"'</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Selection</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">networkCascade</span>,nv<span class="op">=</span><span class="fl">0.133</span>, gr<span class="op">=</span><span class="va">Selection</span><span class="op">@</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotnet-1.png" alt="plot of chunk plotnet" width="100%"><p class="caption">
plot of chunk plotnet
</p>
</div>
</div>
<div class="section level3">
<h3 id="perform-gene-selection">Perform gene selection<a class="anchor" aria-label="anchor" href="#perform-gene-selection"></a>
</h3>
<p>Import data.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/Patterns/" class="external-link">Patterns</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/CascadeData/" class="external-link">CascadeData</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">micro_S</span><span class="op">)</span></span>
<span><span class="va">micro_S</span><span class="op">&lt;-</span><span class="fu"><a href="reference/as.omics_array.html">as.omics_array</a></span><span class="op">(</span><span class="va">micro_S</span>,time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">90</span>,<span class="fl">210</span>,<span class="fl">390</span><span class="op">)</span>,subject<span class="op">=</span><span class="fl">6</span>,gene_ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">micro_S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">micro_US</span><span class="op">)</span></span>
<span><span class="va">micro_US</span><span class="op">&lt;-</span><span class="fu"><a href="reference/as.omics_array.html">as.omics_array</a></span><span class="op">(</span><span class="va">micro_US</span>,time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">90</span>,<span class="fl">210</span>,<span class="fl">390</span><span class="op">)</span>,subject<span class="op">=</span><span class="fl">6</span>,gene_ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">micro_US</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Select early genes (t1 or t2):</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Selection1</span><span class="op">&lt;-</span><span class="fu"><a href="reference/geneSelection.html">geneSelection</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">micro_S</span>,y<span class="op">=</span><span class="va">micro_US</span>,<span class="fl">20</span>,wanted.patterns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Section genes with first significant differential expression at t1:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Selection2</span><span class="op">&lt;-</span><span class="fu"><a href="reference/geneSelection.html">geneSelection</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">micro_S</span>,y<span class="op">=</span><span class="va">micro_US</span>,<span class="fl">20</span>,peak<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Section genes with first significant differential expression at t2:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Selection3</span><span class="op">&lt;-</span><span class="fu"><a href="reference/geneSelection.html">geneSelection</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">micro_S</span>,y<span class="op">=</span><span class="va">micro_US</span>,<span class="fl">20</span>,peak<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Select later genes (t3 or t4)</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Selection4</span><span class="op">&lt;-</span><span class="fu"><a href="reference/geneSelection.html">geneSelection</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">micro_S</span>,y<span class="op">=</span><span class="va">micro_US</span>,<span class="fl">50</span>,</span>
<span>wanted.patterns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Merge those selections:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Selection</span><span class="op">&lt;-</span><span class="fu"><a href="reference/unionOmics-methods.html">unionOmics</a></span><span class="op">(</span><span class="va">Selection1</span>,<span class="va">Selection2</span><span class="op">)</span></span>
<span><span class="va">Selection</span><span class="op">&lt;-</span><span class="fu"><a href="reference/unionOmics-methods.html">unionOmics</a></span><span class="op">(</span><span class="va">Selection</span>,<span class="va">Selection3</span><span class="op">)</span></span>
<span><span class="va">Selection</span><span class="op">&lt;-</span><span class="fu"><a href="reference/unionOmics-methods.html">unionOmics</a></span><span class="op">(</span><span class="va">Selection</span>,<span class="va">Selection4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Selection</span><span class="op">)</span></span>
<span><span class="co">#&gt; $omicsarray</span></span>
<span><span class="co">#&gt;                    US60       US90      US210</span></span>
<span><span class="co">#&gt; 210226_at    0.82417544  0.9166931  0.7310784</span></span>
<span><span class="co">#&gt; 233516_s_at -0.27395188 -2.3695246  0.6511830</span></span>
<span><span class="co">#&gt; 202081_at    0.60477249  0.6599672 -0.1884742</span></span>
<span><span class="co">#&gt; 236719_at   -2.07284086 -0.3123747  0.1792494</span></span>
<span><span class="co">#&gt; 236019_at   -0.08175065 -0.3699708 -0.4315901</span></span>
<span><span class="co">#&gt; 1563563_at  -1.44513486  1.6869516 -0.4297297</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $name</span></span>
<span><span class="co">#&gt; [1] "210226_at"   "233516_s_at" "202081_at"   "236719_at"   "236019_at"  </span></span>
<span><span class="co">#&gt; [6] "1563563_at" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gene_ID</span></span>
<span><span class="co">#&gt; [1] "210226_at"   "233516_s_at" "202081_at"   "236719_at"   "236019_at"  </span></span>
<span><span class="co">#&gt; [6] "1563563_at" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $group</span></span>
<span><span class="co">#&gt; [1] 1 2 1 1 1 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $start_time</span></span>
<span><span class="co">#&gt; [1] 1 2 1 1 1 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $time</span></span>
<span><span class="co">#&gt; [1]  60  90 210 390</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $subject</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>Summarize the final selection:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Selection</span><span class="op">)</span></span>
<span><span class="co">#&gt;       US60               US90               US210             US390         </span></span>
<span><span class="co">#&gt;  Min.   :-2.76841   Min.   :-2.369525   Min.   :-1.6147   Min.   :-2.60480  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.18028   1st Qu.:-0.181425   1st Qu.: 0.1985   1st Qu.:-0.03884  </span></span>
<span><span class="co">#&gt;  Median : 0.05675   Median :-0.001924   Median : 0.9886   Median : 0.31766  </span></span>
<span><span class="co">#&gt;  Mean   : 0.05764   Mean   : 0.278275   Mean   : 0.9611   Mean   : 0.26428  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.22438   3rd Qu.: 0.664063   3rd Qu.: 1.6918   3rd Qu.: 0.57117  </span></span>
<span><span class="co">#&gt;  Max.   : 2.86440   Max.   : 4.284675   Max.   : 3.6727   Max.   : 2.54704  </span></span>
<span><span class="co">#&gt;       US60              US90              US210              US390         </span></span>
<span><span class="co">#&gt;  Min.   :-2.7932   Min.   :-2.49245   Min.   :-1.21606   Min.   :-1.74407  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.5547   1st Qu.:-0.01944   1st Qu.: 0.07966   1st Qu.:-0.26548  </span></span>
<span><span class="co">#&gt;  Median :-0.3089   Median : 0.14977   Median : 0.72019   Median : 0.03616  </span></span>
<span><span class="co">#&gt;  Mean   :-0.2917   Mean   : 0.33720   Mean   : 0.73063   Mean   : 0.06753  </span></span>
<span><span class="co">#&gt;  3rd Qu.:-0.1725   3rd Qu.: 0.48744   3rd Qu.: 1.26164   3rd Qu.: 0.32496  </span></span>
<span><span class="co">#&gt;  Max.   : 2.0267   Max.   : 3.37588   Max.   : 3.87950   Max.   : 2.83321  </span></span>
<span><span class="co">#&gt;       US60               US90             US210             US390        </span></span>
<span><span class="co">#&gt;  Min.   :-2.94444   Min.   :-0.9721   Min.   :-1.9349   Min.   :-3.8418  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.23136   1st Qu.:-0.1027   1st Qu.: 0.3254   1st Qu.:-0.1592  </span></span>
<span><span class="co">#&gt;  Median :-0.04761   Median : 0.2548   Median : 1.2512   Median : 0.1538  </span></span>
<span><span class="co">#&gt;  Mean   : 0.22115   Mean   : 0.6479   Mean   : 1.0485   Mean   : 0.1219  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.33157   3rd Qu.: 1.0737   3rd Qu.: 1.8513   3rd Qu.: 0.6268  </span></span>
<span><span class="co">#&gt;  Max.   : 3.31723   Max.   : 4.3604   Max.   : 4.4860   Max.   : 1.9886  </span></span>
<span><span class="co">#&gt;       US60               US90              US210              US390         </span></span>
<span><span class="co">#&gt;  Min.   :-2.85438   Min.   :-0.90355   Min.   :-0.83324   Min.   :-0.96834  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.06031   1st Qu.:-0.08464   1st Qu.: 0.07605   1st Qu.: 0.01569  </span></span>
<span><span class="co">#&gt;  Median : 0.03601   Median : 0.17135   Median : 0.52176   Median : 0.17370  </span></span>
<span><span class="co">#&gt;  Mean   : 0.14593   Mean   : 0.41929   Mean   : 0.62446   Mean   : 0.23854  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.24568   3rd Qu.: 0.75565   3rd Qu.: 1.07821   3rd Qu.: 0.45189  </span></span>
<span><span class="co">#&gt;  Max.   : 1.82903   Max.   : 3.60640   Max.   : 2.27744   Max.   : 1.90880  </span></span>
<span><span class="co">#&gt;       US60               US90              US210             US390        </span></span>
<span><span class="co">#&gt;  Min.   :-1.38002   Min.   :-2.94444   Min.   :-1.0271   Min.   :-1.3636  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.19910   1st Qu.:-0.01758   1st Qu.: 0.1459   1st Qu.:-0.1386  </span></span>
<span><span class="co">#&gt;  Median :-0.07962   Median : 0.16080   Median : 0.7430   Median : 0.1492  </span></span>
<span><span class="co">#&gt;  Mean   : 0.12972   Mean   : 0.37123   Mean   : 0.7972   Mean   : 0.1271  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.26113   3rd Qu.: 0.61933   3rd Qu.: 1.3922   3rd Qu.: 0.4825  </span></span>
<span><span class="co">#&gt;  Max.   : 2.31074   Max.   : 3.24454   Max.   : 3.6213   Max.   : 1.5979  </span></span>
<span><span class="co">#&gt;       US60               US90              US210             US390         </span></span>
<span><span class="co">#&gt;  Min.   :-1.79176   Min.   :-3.20791   Min.   :-1.4716   Min.   :-1.95883  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.09822   1st Qu.:-0.03963   1st Qu.: 0.1292   1st Qu.:-0.04786  </span></span>
<span><span class="co">#&gt;  Median : 0.03378   Median : 0.28261   Median : 0.8392   Median : 0.22472  </span></span>
<span><span class="co">#&gt;  Mean   : 0.27978   Mean   : 0.52529   Mean   : 0.7903   Mean   : 0.21171  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.33548   3rd Qu.: 1.03256   3rd Qu.: 1.4416   3rd Qu.: 0.42511  </span></span>
<span><span class="co">#&gt;  Max.   : 3.16035   Max.   : 3.19975   Max.   : 2.8027   Max.   : 2.14903</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-omicsselection6-1.png" alt="plot of chunk omicsselection6" width="100%"><p class="caption">
plot of chunk omicsselection6
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection6-2.png" alt="plot of chunk omicsselection6" width="100%"><p class="caption">
plot of chunk omicsselection6
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection6-3.png" alt="plot of chunk omicsselection6" width="100%"><p class="caption">
plot of chunk omicsselection6
</p>
</div>
<p>Plot the final selection:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Selection</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-1.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-2.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-3.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-4.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-5.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-6.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-7.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<div class="figure">
<img src="reference/figures/README-omicsselection7-8.png" alt="plot of chunk omicsselection7" width="100%"><p class="caption">
plot of chunk omicsselection7
</p>
</div>
<p>This process could be improved by retrieve a real gene_ID using the <code>bitr</code> function of the <code>ClusterProfiler</code> package or by performing independent filtering using <code>jetset</code> package to only keep at most only probeset (the best one, if there is one good enough) per gene_ID.</p>
</div>
<div class="section level3">
<h3 id="examples-of-outputs">Examples of outputs<a class="anchor" aria-label="anchor" href="#examples-of-outputs"></a>
</h3>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/figures/README-Fresults-1.png" alt="Infered F matrix of the network (General shape)."><div class="figcaption">Infered F matrix of the network (General shape).</div>
</div>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/figures/README-heatresults-1.png" alt="Infered coefficient matrix of the network (General shape)."><div class="figcaption">Infered coefficient matrix of the network (General shape).</div>
</div>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/figures/README-FresultsLC-1.png" alt="Infered F matrix of the network (cascade shape)."><div class="figcaption">Infered F matrix of the network (cascade shape).</div>
</div>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/figures/README-heatresultsLC-1.png" alt="Infered coefficient matrix of the network (cascade shape)."><div class="figcaption">Infered coefficient matrix of the network (cascade shape).</div>
</div>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/figures/README-plotnet2-1.png" alt="Reverse-engineered network."><div class="figcaption">Reverse-engineered network.</div>
</div>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/evolution/animation.gif" alt="Evolution of a reverse-engineered network with increasing cut-off values."><div class="figcaption">Evolution of a reverse-engineered network with increasing cut-off values.</div>
</div>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/figures/README-plotsimuldata-1.png" alt="Plot of simulated data for cascade networks featuring cluster membership."><div class="figcaption">Plot of simulated data for cascade networks featuring cluster membership.</div>
</div>
<div class="float">
<img src="https://fbertran.github.io/Patterns/reference/figures/README-plotsimuldata-2.png" alt="Plot of simulated data for cascade networks featuring subject membership."><div class="figcaption">Plot of simulated data for cascade networks featuring subject membership.</div>
</div>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=Patterns" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/fbertran/Patterns/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/fbertran/Patterns/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Patterns</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Frederic Bertrand <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-0837-8281" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Myriam Maumy-Bertrand <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-4615-1512" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-green.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/fbertran/Patterns/actions" class="external-link"><img src="https://github.com/fbertran/Patterns/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/fbertran/Patterns?branch=master" class="external-link"><img src="https://codecov.io/gh/fbertran/Patterns/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://cran.r-project.org/package=Patterns" class="external-link"><img src="https://www.r-pkg.org/badges/version/Patterns" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=Patterns" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/Patterns" alt="CRAN RStudio mirror downloads"></a></li>
<li><a href="https://github.com/fbertran/Patterns" class="external-link"><img src="https://img.shields.io/github/stars/fbertran/Patterns?style=social" alt="GitHub Repo stars"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/18441799" class="external-link"><img src="https://zenodo.org/badge/18441799.svg" alt="DOI"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
